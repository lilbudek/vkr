%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[a4paper, 14pt]{extarticle}
\usepackage[top=20mm, left=30mm, right=10mm, bottom=20mm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
\usepackage{indentfirst}
\usepackage{graphicx, animate}
\usepackage{amsmath}
\usepackage{float}
\usepackage{setspace}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{diagbox}
\usepackage{color}
\usepackage[unicode, pdftex]{hyperref}
\usepackage{minted}
\graphicspath{{pictures/}}
\DeclareGraphicsExtensions{.png,.jpg}
\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\section*{Актуальность}
	В ходе эксплуатации электронных устройств регулярно возникает необходимость в настройке. На входы устройства принимают сигналы, форма которых задается напряжением. Для тестирования и отладки могут понадобиться как цифровые, так и аналоговые сигналы разной формы. Формирование аналоговых сигналов может обеспечить специализированное устройство --- генератор сигналов.
	
	Генератор сигналов --- это неотъемлемый инструмент для любого специалиста в области электроники. На сегодняшний день разрабатывается достаточно много генераторов сигналов, но не все генераторы, которые есть на рынке, обладают компактными размерами, лёгкостью транспортировки и доступностью в цене. 

\section*{Методы генерации}
Можно выделить несколько ключевых методов цифровой генерации сигнала, а также их основные преимущества и недостатки.

Среди всех методов, наиболее выделяется **метод DDS** за его универсальность,
 гибкость и простоту реализации. Он позволяет создавать различные формы сигналов
 с высокой точностью и быстродействием, что делает его идеальным выбором для создания функционального генератора.
 
\textbf{Метод DDS}

\section*{Существующие генераторы}	
	В настоящее время существуют полноразмерные генераторы сигналов и генераторы реализованные всего лишь на одной микросхеме. Полноразмерные обладают высокими характеристиками, но не у всех пользователей есть в них надобность и тем более стоимость за такие характеристики очень существенная, а также у полноразмерного генератора большие габариты.
	
	Быстрое и непрерывное развитие схемотехники привело к появлению маленьких микросхем, реализующих функционал генератора сигнала. Например, микросхема программируемого генератора AD9833. Несомненными плюсами является низкая стоимость, маленькие габариты, малое энергопотребление в сочетании с хорошим качеством выходного сигнала, но недостатком такого генератора является необходимость в управляющем устройстве. Для работы с ним понадобится, например, микроконтроллер, который будет отправлять команды для установки параметров выходного сигнала, то есть помимо самого микроконтроллера потребуется разработать программу для работы с таким видом синтезатора.

	\textit{Исходя из достоинств и недостатков}. Гораздо эффективнее будет разработать генератор сигналов на одном микроконтроллере тем самым будут сэкономлены ресурсы и система получится довольно гибкой.
\section*{Выбор МК и инструментов}
	Были рассмотрены два популярных семейства микроконтроллеров AVR и STM32.
	
	Исходя из таблицы можно сделать вывод, что микроконтроллеры AVR применимы в малом спектре задач где скорость не так важна. В нашем же случае скорость работы микроконтроллера может сильно влиять на генерацию сигнала, а также требуется объём памяти для хранения отсчётов сигналов. В микроконтроллерах STM32 с частотой и объёмом памяти проблем нет и они имеют широкое применение. Серию же выберем F103xC за её характеристики. В связи с этим, а также доступностью отладочных плат будет применён микроконтроллер STM32F103RCT6.
	
	Попользовавшись средами разработки и разными библиотеками, а также основываясь на достоинствах и недостатках была выбрана среда разработки PlatformIO в связке с библиотекой libopencm3.
	
\section*{Программа}
	Структурно устройство будет выглядеть следующим образом. Цифро-аналоговый преобразователь будет использоваться встроенный в микроконтроллер, а в качестве дисплея будет выступать OLED экран с разрешением 128 на 64 пикселя, работающий по интерфейсу I2C.

	Программа должна выполнять три действия:
	
	\begin{enumerate}
		\item Вывод отсчёта в ЦАП;
		\item Обработка кнопок;
		\item Вывод информации на дисплей.
	\end{enumerate}
	
	
	Для цифро-аналогового преобразователя и кнопок были выделены два таймера общего назначения, а работа с дисплеем организована в главном цикле программы. Применив такой подход, удастся добиться синхронного выполнения программы. 
	
	Подпрограмма вывода отсчёта в ЦАП содержит в себе вывод значения и вычисления адреса, в котором заложен метод DDS.
	
	Подпрограмма обработки кнопок находится в обработчике прерывания таймера номер 3. Таймер настроен на период 250 миллисекунд. Благодаря такой организации, решается проблема дребезга кнопок. Не приходится делать программную или аппаратную задержку для ожидания установки состояния кнопки. Состоит функция из 5 подпрограмм (далее пояснения блок-схемами по порядку).
	
	В главном цикле помимо работы с дисплеем расположены настройки периферии (сказал какой периферии и далее пояснение работы дисплея).
	
\section*{Аппарат}
	По структурной схеме был создан фрагмент схемы электрической принципиальной.
	
	Сконструирована плата периферии. 
	 
	Затем получился макет устройства, состоящий из отладочной платы и платы периферии.
	
\section*{Тестирование}
	После создания макета была проверена его работоспособность. На слайде можно видеть состояние самого устройства и что происходит в отладчике.
	
	На осциллографе были сняты разные формы сигнала. Здесь представлен синусоидальный сигнал с частотой 1875 Гц, то есть то что мы выставляли на устройстве. 
	
	Было проведено моделирование в Octave. Были взяты записанные осциллографом отсчёты синусоидального сигнала на частоте 1 кГц и построена для сравнения такая же форма сигнала, но с заведомо большей частотой дискретизации. Считаем этот сигнал идеальным. В итоге получим следующее изображение, из которого можно заметить, что сигнал с генератора не совпадает с идеальным, то есть его частота не составляет ровно 1 кГц.
	
	Проведём спектральный анализ нашего сигнала, перейдя от временной составляющей к частотной с помощью быстрого преобразования Фурье. Можно заметить смещение по частоте и утечку фазы.

\end{document}